
apiVersion: patchestry.io/v1

metadata:
  name: "led_loop_before_cmp_operation"
  version: "1.0.0"
  description: "LED loop before cmp operation"
  author: "Security Team"

patches:
  - name: "device_list_replace_sprintf_patch"
    description: "Device list replace sprintf patch"
    category: "device"
    code_file: "patches/bloodview_patch.c"
    function_name: "patch::replace::sprintf"
    parameters: # Parameters are optional and is for reference only
      - name: "argument0"
        type: "string"
        description: "Argument 0"
      - name: "argument1"
        type: "size_t"
        description: "Argument 1"
      - name: "argument2"
        type: "string"
        description: "Argument 2"


contracts:
  - name: "device_list_replace_sprintf_contract"
    description: "Device list replace sprintf patch"
    category: "device"
    severity: "high"
    code_file: "patches/bloodview_patch.c"
    function_name: "contract::sprintf"
    parameters: # Parameters are optional and is for reference only
      - name: "return_value"
        type: "int"
        description: "Return value"
      - name: "dest_size"
        type: "size_t"
        description: "Destination size"